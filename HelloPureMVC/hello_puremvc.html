<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.7: http://docutils.sourceforge.net/" />
<title>PureMVC Hello World教程</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 6253 2010-03-02 00:24:53Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: left }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="puremvc-hello-world">
<h1 class="title">PureMVC Hello World教程</h1>

<p><a class="reference external" href="http://puremvc.org/">PureMVC</a> 是大量使用于flash开发的一个框架,它很好地对处理对象进行了
最常见的MVC模式划分,清晰的逻辑和功能使得开发者能够很好地开发
新的功能,阅读旧的功能等,所以很多的flash的前端代码都是基于 <a class="reference external" href="http://puremvc.org/">PureMVC</a>
开发的.</p>
<img alt="../../images/puremvc.png" src="../../images/puremvc.png" />
<p>最近因为工作上的需要,我开始学习 <a class="reference external" href="http://puremvc.org/">PureMVC</a> ,之前也简单地学习过,也按照
官方的教程完成过一个示例,并且也仔细阅读过 <a class="reference external" href="http://darkstar.puremvc.org/content_header.html?url=http://puremvc.org/pages/docs/current/PureMVC_Implementation_Idioms_and_Best_Practices_cn.pdf&amp;desc=PureMVC%20Docs:%20Best%20Practices%20and%20Implementation%20Idioms%20(Chinese%20Translation)">相关的教程</a> ,但是对于
<a class="reference external" href="http://puremvc.org/">PureMVC</a> 的理解还是相对粗浅,这次在之前理解的基础上做出了一个最简单的
Hello World式的教程,希望加深自己对于这个框架的理解的同时,也能够帮助到
其他人.</p>
<div class="section" id="id1">
<h1>PureMVC Hello World</h1>
<p>这个示例的主要场景如下:</p>
<ol class="arabic simple">
<li>在UI上显示一个登录用的表单</li>
<li>表单上有name, password,和登录的按钮(代码中使用的还是TextField)</li>
<li>点击登录后,如果name,password匹配则显示登录成功,否则显示登录失败</li>
</ol>
<p>基于上面的描述,再根据 <a class="reference external" href="http://puremvc.org/">PureMVC</a> 的框架,我们大致可分为如下几个部分:</p>
<ol class="arabic">
<li><p class="first">启动用的单例AppFacade</p>
</li>
<li><p class="first">Proxy:</p>
<blockquote>
<ul class="simple">
<li>LoginProxy: 用于验证用户提交的表单是否合法</li>
</ul>
</blockquote>
</li>
<li><p class="first">Command:</p>
<blockquote>
<ul class="simple">
<li>StartUpCommand: 用于启动整个应用的Command, 也兼做一些初始化的工作</li>
<li>initMVCCommand: 用于初始化并注册相关的MVC,如mediator, proxy等</li>
<li>LoginCommand: 用于处理Login时的逻辑,如调用LoginProxy来进行验证</li>
</ul>
</blockquote>
</li>
<li><p class="first">Mediator:</p>
<blockquote>
<ul class="simple">
<li>ViewMediator: 用于UI的显示</li>
</ul>
</blockquote>
</li>
</ol>
<p>整个应用的流程为:</p>
<pre class="literal-block">
AppFacade(register command, send notification to start)-&gt; StartUpCommand(execute) -&gt; initMVCCommand(execute, register MVC)
-&gt; ViewMediator(construtor, init the UI)

ViewMediator(Login Button Clicked) -&gt; Login(Notification) -&gt; LoginCommand(verfiy login using LoginProxy) -&gt; Login_Succ/Login_Fail
-&gt; ViewMediator(show the login result message)
</pre>
<p>那么下面我们分别看下重要的几个模块.</p>
<div class="section" id="appfacade">
<h2>AppFacade</h2>
<p>这是用于启动和关联整个 <a class="reference external" href="http://puremvc.org/">PureMVC</a> 通信过程的辅助性类,单例的.
在这个类中主要注意,初始时的notification发送,注册初始时的Command等即可.</p>
<p>具体代码见: <a class="reference external" href="https://github.com/topman/blog_code/blob/master/HelloPureMVC/src/AppFacade.as">https://github.com/topman/blog_code/blob/master/HelloPureMVC/src/AppFacade.as</a></p>
</div>
<div class="section" id="proxy">
<h2>Proxy</h2>
<p>Proxy主要功能是处理数据相关的信息,也即Domain logic(域逻辑),通常它只处理数据,保证数据的正确,完整性等.
而与此不同的是Command,它处理的是Business logic(业务逻辑),它更加关注应用所在业务的相关逻辑.</p>
<p>参考 <a class="reference external" href="http://forums.puremvc.org/index.php?topic=1327.0">Business Logic和Domain Logic的区别</a>.</p>
<p>在示例中的Proxy, 它的主要功能是提供相关的数据, 因为登录验证是一个非常常见的功能,在实际的登录验证中,
通常是后端进行验证,返回一个成功或者失败即可,所以此例中将验证也放入了Proxy的逻辑中.</p>
<p>具体代码见: <a class="reference external" href="https://github.com/topman/blog_code/blob/master/HelloPureMVC/src/model/LoginProxy.as">https://github.com/topman/blog_code/blob/master/HelloPureMVC/src/model/LoginProxy.as</a></p>
</div>
<div class="section" id="command">
<h2>Command</h2>
<p>Command是处理应用的Business Logic(业务逻辑),与Proxy的区别参考上面Proxy的部分.
本例中的Command主要是包括三个,即:</p>
<ul class="simple">
<li>StartUpCommand: 应用启动的命令,调用其它的初始化命令即initMVCCommand</li>
<li>initMVCCommand: 用于初始化整个MVC,注册MVC各个部分</li>
<li>LoginCommand: 用于处理登录逻辑的命令</li>
</ul>
<p>具体的代码见: <a class="reference external" href="https://github.com/topman/blog_code/tree/master/HelloPureMVC/src/controller">https://github.com/topman/blog_code/tree/master/HelloPureMVC/src/controller</a></p>
<p>注意在 <a class="reference external" href="http://puremvc.org/">PureMVC</a> 中命令有MacroCommand和SimpleCommand两类,前者调用后者,后者则实现具体的业务逻辑.</p>
<p>当然所有的逻辑都可以使用SimpleCommand来完成,但是通常MacroCommand命令可以简化整个代码结构,使得
逻辑更加清晰易读.</p>
</div>
<div class="section" id="mediator">
<h2>Mediator</h2>
<p>由于示例比较简单所以只有一个Mediator来处理相关的UI显示, Mediator通常的功能是显示, 接收UI的事件,
响应来自业务逻辑的UI变动等.</p>
<p>示例中主要是两个功能,一个是初始化时显示登录对话框,一个是对于Login_Succ和Login_Fail事件的响应.
相应的代码参考: <a class="reference external" href="https://github.com/topman/blog_code/blob/master/HelloPureMVC/src/view/ViewMediator.as">https://github.com/topman/blog_code/blob/master/HelloPureMVC/src/view/ViewMediator.as</a></p>
</div>
</div>
<div class="section" id="id2">
<h1>结语</h1>
<p>我个人之前更多的是做后端开发,没有系统地接触过前端的开发,如Javascript, flash等. 第一次使用和了解 <a class="reference external" href="http://puremvc.org/">PureMVC</a> ,
发现其理念与后端的MVC框架是一致的,只是在更细层面进行了MVC的划分, 例如一个项目前端是flash,后端是 <a class="reference external" href="http://djangoproject.com">Django</a> ,
<a class="reference external" href="http://djangoproject.com">Django</a> 本身是MVC,而 <a class="reference external" href="http://puremvc.org/">PureMVC</a> 又是在 <a class="reference external" href="http://djangoproject.com">Django</a> 的V层上进行了更加细致的MVC划分.</p>
<p><a class="reference external" href="http://djangoproject.com">Django</a> 的MVC是简洁,清晰和优美的,了解 <a class="reference external" href="http://puremvc.org/">PureMVC</a> 后,同样的特征也适用,我想在后续开发中可以比较熟练地加以应用,
也能够更加顺手地控制工作的进展,不至于项目的进展完全驱动于自己不熟悉的前端.</p>
</div>
<div class="section" id="id3">
<h1>参考资料</h1>
<ol class="arabic simple">
<li><a class="reference external" href="http://puremvc.org/">PureMVC</a></li>
<li><a class="reference external" href="http://djangoproject.com">Django</a></li>
<li><a class="reference external" href="http://darkstar.puremvc.org/content_header.html?url=http://puremvc.org/pages/docs/current/PureMVC_Implementation_Idioms_and_Best_Practices_cn.pdf&amp;desc=PureMVC%20Docs:%20Best%20Practices%20and%20Implementation%20Idioms%20(Chinese%20Translation)">PureMVC教程</a></li>
<li><a class="reference external" href="https://github.com/topman/blog_code/tree/master/HelloPureMVC">本文中相关代码下载</a></li>
</ol>
</div>
</div>
</body>
</html>
